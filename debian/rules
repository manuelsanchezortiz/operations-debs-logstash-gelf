#!/usr/bin/make -f

# Uncomment this to turn on verbose mode.
#export DH_VERBOSE=1

DEB_UPSTREAM_VERSION := $(shell dpkg-parsechangelog | egrep '^Version:' | cut -f 2 -d ' ' | cut -d: -f2- | sed 's/-[^-]*$$//')
export JAVA_HOME=/usr/lib/jvm/default-java

# Put depended upon jars in here
# export CLASSPATH=

get-orig-source:
	pristine-tar checkout ../logstash-gelf_$(DEB_UPSTREAM_VERSION).orig.tar.gz

%:
	dh $@ --with javahelper --with jh_maven_repo_helper

override_dh_auto_build:
	mvn package
	mvn javadoc:javadoc

override_dh_auto_install:
	mh_installpoms -pliblogstash-gelf-java
	mh_installjar  -pliblogstash-gelf-java pom.xml target/logstash-gelf-$(DEB_UPSTREAM_VERSION).jar \
		--java-lib --usj-version=$(DEB_UPSTREAM_VERSION)

override_dh_auto_clean:
	#rm -rf target/
	mh_clean
	jh_clean
	dh_auto_clean
